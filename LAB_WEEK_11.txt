Keisen Susanto
00000078136

Answer these questions based on Part 3 of the tutorial:
1. When a user takes a picture, that picture is stored in a path based on the given
URI. In which part of the code handles this? (Copy that part of the code as the
answer)
2. In your FileInfo.kt, there are 5 attributes. On the first attribute, what does the URI
refer to? And on the fourth attribute, what does relativePath refer to?
3. [Bonus] Explain the chronological order from when a user takes a picture until
the file is stored in the MediaStore.

Ans

1. Bagian kode yang menyimpan foto berdasarkan URI

Kode yang menangani penyimpanan foto ke path berdasarkan URI adalah:

takePictureLauncher =
    registerForActivityResult(ActivityResultContracts.TakePicture()) {
        providerFileManager.insertImageToStore(photoInfo)
    }


Dan proses penyimpanan sebenarnya dilakukan oleh:

private fun insertToStore(fileInfo: FileInfo, contentUri: Uri, contentValues: ContentValues) {
    executor.execute {
        val insertedUri = contentResolver.insert(contentUri, contentValues)
        insertedUri?.let {
            val inputStream = contentResolver.openInputStream(fileInfo.uri)
            val outputStream = contentResolver.openOutputStream(insertedUri)
            IOUtils.copy(inputStream, outputStream)
        }
    }
}

2. Penjelasan atribut FileInfo.kt
data class FileInfo(
    val uri: Uri,
    val file: File,
    val name: String,
    val relativePath: String,
    val mimeType: String
)

a. Atribut pertama (uri)

uri adalah URI sementara dari FileProvider yang diberikan ke kamera sebagai lokasi penyimpanan sementara hasil foto/video.

URI ini dipakai kamera untuk menaruh file sebelum dipindahkan ke MediaStore.

b. Atribut keempat (relativePath)

relativePath menunjukkan folder tujuan di dalam MediaStore, misalnya:

"Pictures"

"Movies"

RelativePath memberi tahu MediaStore di folder mana file harus disimpan.

3. Urutan proses penyimpanan foto ke MediaStore

User menekan tombol Photo
openImageCapture() membuat photoInfo berisi uri, file, nama file, relative path, dan mime type.

Kamera dibuka
Dipanggil lewat:

takePictureLauncher.launch(photoInfo.uri)


Kamera menyimpan foto ke URI sementara dari FileProvider.

Foto berhasil diambil
Callback dijalankan:

providerFileManager.insertImageToStore(photoInfo)


File dipindahkan ke MediaStore
insertToStore() menyalin file dari URI sementara ke folder MediaStore menggunakan inputStream dan outputStream.

Foto muncul di galeri
MediaStore meng-index file sehingga file muncul di Gallery, File Manager, atau aplikasi lain.